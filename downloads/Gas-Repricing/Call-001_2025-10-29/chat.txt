00:04:06	jochem-brouwer:	gm :)
00:04:11	Ansgar Dietrichs:	gm gm
00:04:11	Wei Han Ng:	gmgm
00:04:18	Milos:	gm
00:04:34	jochem-brouwer:	https://github.com/ethereum/pm/issues/1784
00:07:34	Ansgar Dietrichs:	it‚Äôs obviously just an illustration, these spikes are not based on actual metrics :-)
00:08:03	Ansgar Dietrichs:	Replying to "it‚Äôs obviously just ..."

but I think it nicely shows the core idea of repricing
00:08:16	Carl Beekhuizen:	Replying to "it‚Äôs obviously just ..."

If we had ‚Äúactual metrics‚Äù we‚Äôd be living in a very different world
00:08:34	Carl Beekhuizen:	Replying to "it‚Äôs obviously just ..."

soon (tm)
00:10:11	Kamil Chodo≈Ça:	Replying to "it‚Äôs obviously ju..."

Question: Why current benchmarks are not actual metrics? :)
00:11:05	Ansgar Dietrichs:	Replying to "it‚Äôs obviously just ..."

no I was just talking about these graphics, would just be a lot of extra work to actually render it based on the benchmarks. and would be less illustrative
00:11:22	Carl Beekhuizen:	Replying to "it‚Äôs obviously just ..."

Just that there is a lot of data missing
00:11:35	Carl Beekhuizen:	Replying to "it‚Äôs obviously just ..."

But we‚Äôre getting there
00:11:51	Kamil Chodo≈Ça:	Replying to "it‚Äôs obviously ju..."

Ahh ok - got it know - yeah then soon (tm) indeed
00:11:58	Carl Beekhuizen:	Reacted to "Ahh ok - got it know..." with ‚ù§Ô∏è‚Äçüî•
00:11:59	Ansgar Dietrichs:	Reacted to "Ahh ok - got it know..." with üî•
00:13:51	Ansgar Dietrichs:	I would say state growth is not technically part of the main harmonization, because it is about long term effects, not the per-block performance like the others. but it is of course also very important, otherwise these long term concerns become the bottleneck
00:17:08	Ansgar Dietrichs:	will there be time for quesitons / comments after each presentation?
00:17:31	Maria Silva:	If the presenter doesn‚Äôt use all their time with the presentation
00:17:44	Ansgar Dietrichs:	Reacted to "If the presenter doe..." with üëç
00:20:05	Maria Silva:	I would say that these values may have to change based on the final numbers on the compute and state EIPs
00:20:24	Ansgar Dietrichs:	otherwise maybe comment here - we just have to keep in mind that this EIP currently tries to reprice to where the other costs are today, not where they are going.

we might at least consider rescaling all the costs everywhere so that 21k (for a tx to an existing recipient) is the proper cost again
00:23:07	Carl Beekhuizen:	For all repricing EIPs, we should assume that the exact numbers are liable to change until we decide on our anchor
00:23:13	Wei Han Ng:	Reacted to "For all repricing EI..." with üëç
00:23:57	Ansgar Dietrichs:	Replying to "For all repricing EI..."

and also relative to each other, because of changing / better benchmarks.

really, the EIPs for now are more intentions what parts to change, not the details of the change :-)
00:24:18	jochem-brouwer:	Should we make a meta document to specify the constants? I see a lot of new constants being introduced in these EIPs but I think for some cases they mean the same
00:24:24	Ansgar Dietrichs:	and multiple writes to same account also don‚Äôt cause extra BAL entries, so another reason to have a warm account write concept
00:24:42	Carl Beekhuizen:	Replying to "For all repricing EI..."

Lol, was just typing the same:

‚ÄúAnd even then we‚Äôll need to do standardized benchmarking before we lock anything in‚Äù
00:24:46	Carl Beekhuizen:	Reacted to "and also relative to..." with üëç
00:24:50	Marius van der Wijden:	I don't like this EIP
00:24:51	Toni Wahrst√§tter:	Reacted to and multiple writes ... with "üëç"
00:25:03	Carl Beekhuizen:	Reacted to "and multiple writes ..." with üëç
00:25:53	Marius van der Wijden:	Replying to "I don't like this ..."

Ah wait its not really what I thought it would be
00:26:02	Carl Beekhuizen:	Replying to "I don't like this EI..."

lol
00:26:15	Ansgar Dietrichs:	Reacted to "Ah wait its not real..." with üòÇ
00:26:26	Radek | zkevm:	Replying to "I don't like this EI..."

So you like it now?
00:26:27	Francesco:	Replying to "I don't like this EI..."

Screenshotting this just in case
00:26:38	Marius van der Wijden:	Replying to "I don't like this ..."

I thought this was cross-transactions
00:26:55	Marius van der Wijden:	Replying to "I don't like this ..."

It is just within a transaction, right?
00:27:27	jochem-brouwer:	Antwoord verzenden naar "I don't like this ..."

Yes (wow I cannot use zoom chat)
00:28:37	Ansgar Dietrichs:	right, but the problem is we will not be able to keep the invariants around what you can and cannot do with this old solidity enshrined gas stipend anyway
00:29:42	Ben Adams:	Replying to "right, but the probl..."

Is just a problem if go too far under 1400 gas for a call value transfer' otherwise the invariant still holds
00:30:24	Ben Adams:	Replying to "right, but the probl..."

We charge 9000 atm; so plenty of room to drop the price
00:31:37	Ansgar Dietrichs:	Replying to "right, but the probl..."

but is this really the only concern around the stipend?
00:31:48	Ben Adams:	Reacted to "but is this really t..." with üëç
00:32:14	Ben Adams:	Replying to "right, but the probl..."

recursive calls on ETH transfer
00:32:48	Carl Beekhuizen:	2 comments:

1) 7973 becomes especially necessary when we increase write costs to curb state growth
2) I have some early empirical data that shows with a  128x increase in all gas costs, ~11% of all transactions now contain contract calls that fail. And this is not from naive out of gas errors. (And 65% of all transactions have a different outcome) (Still working on exact numbers, but it‚Äôs not negligible)
00:32:53	Toni Wahrst√§tter:	Replying to "right, but the probl..." 

 I remember that bloating others' contracts to hav users pay more was a concern.
00:33:16	Maria Silva:	Reacted to "2 comments:

1) 7973..." with üëç
00:33:24	Toni Wahrst√§tter:	Replying to "right, but the probl..." 

 Which might be expensive, depending on the threshold
00:33:38	Ansgar Dietrichs:	Replying to "right, but the probl..."

@Toni Wahrst√§tter I think you are talking about Guillaume‚Äôs EIP, no?
00:33:47	Ansgar Dietrichs:	Replying to "right, but the probl..."

this thread is about the other EIP
00:33:52	Toni Wahrst√§tter:	What was the threshold such that only 1 contract was affected?
00:33:56	CPerezz:	Replying to "right, but the probl..."

I remember that bloating others' contracts to hav users pay more was a concern.

That‚Äôs prohibitively costly
00:34:07	Toni Wahrst√§tter:	Reacted to @Toni Wahrst√§tter I ... with "üëç"
00:34:22	CPerezz:	Replying to "right, but the probl..."

Induce enough state size to make the cost increase is Millions and Millions of dollars
00:34:26	CPerezz:	Replying to "right, but the probl..."

And takes a lot of time
00:34:32	CPerezz:	Replying to "right, but the probl..."

SO I don‚Äôt think this is a valid concern
00:35:29	CPerezz:	XEN size
00:35:33	CPerezz:	Approx
00:36:22	jochem-brouwer:	Have to check but the XEN state is likely not increasing a lot. The slow blocks only overwrite existing slots but do not introduce new ones
00:37:17	CPerezz:	Have to check but the XEN state is likely not increasing a lot. The slow blocks only overwrite existing slots but do not introduce new ones
Yet its blocks are the ones that cause major Perf issues to nodes atm. 

So even if not massively used, it‚Äôs the critical unlock for 100M gas for example
00:38:06	CPerezz:	By the time USDT is there, we should have state expiry no?
00:38:25	Ben Adams:	Replying to "By the time USDT is ..."

Assume nothing :)
00:38:28	Francesco:	What is the ratio between XEN and USDT state?
00:38:28	Ameziane Hamlat:	Replying to "Have to check but th..."

That‚Äôs what I noticed as well, most of the SSTORE calls are overwriting existing slots
00:38:29	CPerezz:	Reacted to "Assume nothing :)" with üòÖ
00:38:45	CPerezz:	Replying to "What is the ratio be..."

9.8GB vs not even 2GB size
00:38:49	Guillaume:	Reacted to "Assume nothing :)" with üòÖ
00:38:51	Wei Han Ng:	Replying to "What is the ratio be..."

Just on top of my head, XEN has ~80M slots and USDT had ~20M slots
00:39:14	Ameziane Hamlat:	Replying to "Have to check but th..."

Some of them are setting slots to zero to get that refund from the block
00:39:45	Wei Han Ng:	Reacted to "Assume nothing :)" with üòÖ
00:39:49	CPerezz:	Indeed. But even doing so. State root recomputation induced IO is massive
00:40:53	Toni Wahrst√§tter:	Replying to "What is the ratio be..." 

 How much could it grow from 80M with the proposed exponential(?) Increase in costs before it becomes inpractical?
00:42:31	Ansgar Dietrichs:	only comment is that I think the targets are too conservative, I would cut all the price increases in half :-)
00:43:09	Marius van der Wijden:	Replying to "only comment is th..."

I disagree :D
00:43:13	Ansgar Dietrichs:	Reacted to "I disagree :D" with üòÇ
00:43:17	Carl Beekhuizen:	Replying to "only comment is that..."

yeah both 60gb and 300M seem very conservative
00:43:17	Marius van der Wijden:	60gb is not conservative
00:43:50	Francesco:	What does target mean here? Assuming some percentage of the gas is used for it?
00:43:53	Ansgar Dietrichs:	Replying to "only comment is that..."

@Marius van der Wijden why is that?
00:43:58	CPerezz:	Replying to "only comment is that..."

+1 Marius.  Notice this shortens our time to deliver expiry or similar solutions to battle size increases
00:44:19	Francesco:	Replying to "only comment is that..."

How does it shorten the time if right now the state growth is greater than that?
00:44:32	Ansgar Dietrichs:	Reacted to "How does it shorten ..." with üëç
00:44:39	Luis Pinto | Besu:	Is this not disincentivizing new people to ethereum compared to who is already around?
00:44:41	Wei Han Ng:	Replying to "What is the ratio be..."

The EIP itself doesn't have any numbers for the parameters at the moment. We'll have to play around with the formula and find the best one
00:44:53	Marius van der Wijden:	Replying to "only comment is th..."

Geth currently stores the data twice, as trie nodes and as a snapshot, so the increase is actually 2x that
00:44:56	Toni Wahrst√§tter:	Reacted to The EIP itself doesn... with "üëç"
00:45:13	Marius van der Wijden:	Replying to "only comment is th..."

From the last numbers I seen, state growth is slower than 60GB/year
00:45:27	CPerezz:	Replying to "Is this not disincen..."

Why is that exactly?
00:45:48	Francesco:	Replying to "only comment is that..."

But we are also 5x away from 300M gas
00:45:52	Ben Adams:	Replying to "Is this not disincen..."

because they will create new state and accounts
00:45:56	Marius van der Wijden:	Replying to "only comment is th..."

https://www.paradigm.xyz/2024/03/how-to-raise-the-gas-limit-1
00:46:03	Luis Pinto | Besu:	Replying to "Is this not disincen..."

So isn‚Äôt it just increasing costs all across the board?
00:46:12	Marius van der Wijden:	Replying to "only comment is th..."

Oh those are 2024 numbers
00:46:18	Ansgar Dietrichs:	right, if state growth is below 60GB, then we don‚Äôt need a 10x to go from 45M to 300M
00:46:31	Carl Beekhuizen:	30% IIRC
00:47:32	Ansgar Dietrichs:	I think this doesn‚Äôt yet take BAL data size into account, right? so these operations would have to become a bit more expensive?
00:47:54	Luis Pinto | Besu:	I agree with harmonisation not disincentivizing usage of state because of state growth which is crucial for usage of the blockchain. Like new user that are onboarded need new accounts
00:48:31	Ansgar Dietrichs:	just do a 3 sentence recap maybe
00:48:37	Ben Adams:	Reacted to "just do a 3 sentence..." with üëç
00:49:27	Maria Silva:	Replying to "What does target mea..."

I assume we use an average of 30% of the block target
00:49:54	Maria Silva:	Replying to "What does target mea..."

This 30% was taken from the multidimensional metering empirical analysis
00:50:11	Carl Beekhuizen:	Replying to "Is this not disincen..."

But we can‚Äôt harmonize state-growth with everything else. Most other constraints are burst load, but state growth is about the long terms. We have to start with a limit on how we want state to grow and work back from that
00:50:22	Toni Wahrst√§tter:	This feels cleaner if done as a new tx type instead of using ALs.
00:50:24	Maria Silva:	Reacted to "But we can‚Äôt harmoni..." with üíØ
00:51:08	Carl Beekhuizen:	Replying to "Is this not disincen..."

Basically we‚Äôre not making state more expensive, it‚Äôs more making compute much cheaper (because we don‚Äôt play long term costs for it) and that makes state growth relatively more expensive
00:51:30	Francesco:	Reacted to "Basically we‚Äôre not ..." with üíØ
00:51:31	Ameziane Hamlat:	Replying to "This feels cleaner i..."

I think it is proposed under access list transaction per EIP-2930 if I‚Äôm not wrong
00:51:40	CPerezz:	Reacted to "I think it is propos..." with üëç
00:52:02	Carl Beekhuizen:	Replying to "This feels cleaner i..."

Yes, but we shouldn‚Äôt overload access lists further
00:52:04	Toni Wahrst√§tter:	Replying to "This feels cleaner i..." 

 Right, but it'd be cleaner to have a new tx type.
Blob txs may not need that functionality.
00:52:12	Guillaume:	Replying to "This feels cleaner i..."

the AL eip says it could be used for more things, and you don't need to test a new tx type, which is good
00:52:33	Ansgar Dietrichs:	right, my feeling is it would be useful for some portion of existing contracts, but would more importantly set good incentives going forward
00:52:55	Ben Adams:	Reacted to "right, my feeling is..." with üëç
00:52:57	Carl Beekhuizen:	we have 252 transaction types left, this seems like a good use of them. Why hack it onto ALs?
00:53:22	Carl Beekhuizen:	Replying to "This feels cleaner i..."

Much easier to reason about and make changes in the future
00:53:30	Wei Han Ng:	Replying to "This feels cleaner i..."

We did consider new tx type. But we thought that it may be unnecessary and introduces more complexity.

ALs already warm the account. Hence, the change EL need to do is to construct the code hash set from the access list, and during the calculation of contract creation gas cost, if the resulting code hash already exists in the set, then just discount it.
00:54:25	Ansgar Dietrichs:	aaah my bad, so this is not a backwards compatible deduplication, just a new deployment option going forward
00:54:31	Ansgar Dietrichs:	Replying to "aaah my bad, so this..."

got it
00:55:12	Carl Beekhuizen:	Reacted to "right, my feeling is..." with üëç
00:55:59	CPerezz:	Reacted to "aaah my bad, so this..." with üëç
00:56:09	Ansgar Dietrichs:	but yes then I would say this access list part of the EIP is the one we should most double check that we actually prefer it
00:56:09	CPerezz:	Reacted to "right, my feeling is..." with üëç
00:56:33	CPerezz:	Replying to "but yes then I would..."

More TX types feels super messy.. But, happy to debate/discuss
00:56:43	Ansgar Dietrichs:	Replying to "but yes then I would..."

right, I mean more in terms of a reverse map
00:56:48	CPerezz:	Replying to "but yes then I would..."

Also, It‚Äôs nice to give more usage to ALs
00:56:52	Ansgar Dietrichs:	Replying to "but yes then I would..."

so just completely abstract it from users
00:56:54	Luis Pinto | Besu:	Sure, relatively compute gets cheaper. What I‚Äôm saying is that a basic operation like sending money to a new user gets more expensive.
I‚Äôm just leaning on the motivation item that we are disincentivizing state growth and I don‚Äôt like this sentence, instead of fixing the state growth problem. I‚Äôll study the EIP better, maybe I missed something.
00:56:54	CPerezz:	Replying to "but yes then I would..."

As they have few
00:57:15	CPerezz:	Replying to "but yes then I would..."

so just completely abstract it from users
Wallets can already do that right? User won‚Äôt see anything. Just enjoy the discount
00:57:20	Ansgar Dietrichs:	Replying to "but yes then I would..."

I don‚Äôt think a ‚Äúpublic works program‚Äù for access lists is a valid motivation haha
00:57:35	CPerezz:	Reacted to "because they will cr..." with üëç
00:57:58	Carl Beekhuizen:	Replying to "Is this not disincen..."

But like these are the actual costs to the protocol. You are arguing for subsidizing bloating the state for the sake of new users. Those incentives can go really wrong
00:58:28	Ansgar Dietrichs:	question to code chunking: would then also the list of all sections of code acceessed be in the BALs? is there some metrics on how much it would increase the typical BAL size?
00:58:49	CPerezz:	Reacted to "I don‚Äôt think a ‚Äúpub..." with üòÇ
00:59:43	Ansgar Dietrichs:	and do we have metrics for whether 31 bytes is optimal chunk size? my intuition is that maybe somewhat longer chunks could be preferable

or is there a specific reason to align with EVM word size?
01:01:28	Wei Han Ng:	Replying to "and do we have metri..."

There's no analysis on 31 bytes is the best one. We should try with different chunk size.

Smaller chunks are more efficient (i.e. have higher chunk utilization), but incur a larger hash overhead. Larger chunks are less efficient, but incur less hash overhead.
01:02:17	Wei Han Ng:	Replying to "question to code chu..."

why would accessed chunks needed in BALs?
01:02:18	CPerezz:	Replying to "and do we have metri..."

Hashing is almost free. I think IO is what is important when we go towards smaller chunck sizes. As we will have a lot more to pull for every root computation
01:02:19	Luis Pinto | Besu:	I like this change. Currently there‚Äôs nowhere in the protocol specified how byte code is loaded and how clients access it. Pragmatically I think this is a problem.
Increasing deployed code size is a problem. We cannot measure how big it is before loading it. And this is a change that the community is very much interested on.
01:02:51	Ben Adams:	Replying to "question to code chu..."

so know what to load
01:02:58	jochem-brouwer:	I think all chat questions should be sent to the EIP authors :)
01:02:59	Guillaume:	Replying to "and do we have metri..."

Sina did an analysis back in the day
01:03:39	CPerezz:	Reacted to "I think all chat que..." with üëç
01:03:40	Guillaume:	Replying to "question to code chu..."

yes it could be added to the BAL
